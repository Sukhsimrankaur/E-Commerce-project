<h1>Shop Products</h1>

<!-- Include the search form partial -->
<%= render 'search_form' %>

<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
  <% @products.each do |product| %>
    <div class="product-card" style="border: 1px solid #ccc; padding: 10px; border-radius: 8px;">
      
      <%= link_to product_path(product), style: "text-decoration: none; color: inherit;" do %>
        <% if product.image.attached? %>
          <%= image_tag product.image, size: "200x200" %>
        <% else %>
          <p>No image</p>
        <% end %>
        <h2><%= product.name %></h2>
        <p><strong>Price:</strong> <%= number_to_currency(product.price) %></p>
        <p><strong>Category:</strong> <%= product.category&.name %></p>
        <p><%= truncate(product.description, length: 100) %></p>
      <% end %>

      <%= form_with url: add_to_cart_path(product.id), method: :post, local: true do %>
        <div style="margin-top: 10px;">
          <%= number_field_tag :quantity, 1, min: 1, class: "form-control", style: "width: 60px;" %>
          <%= submit_tag "Add to Cart", class: "btn btn-primary", style: "margin-top: 5px;" %>
        </div>
      <% end %>
      
    </div>
  <% end %>
</div>

<% if @products.empty? %>
  <p>No products available at the moment.</p>
<% end %>
